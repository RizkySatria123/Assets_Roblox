import bpy
import math

COLLECTION_NAME = "Chicken"
OBJECT_NAME = "Chicken"
MESH_NAME = "Chicken_Mesh"
UV_LAYER_NAME = "UVMap"
FLIP_V = False
MOVE_TO_ORIGIN = True

ROT_X_DEG = 90.0
ROT_Y_DEG = 0.0
ROT_Z_DEG = 0.0

VERTS = [
    (-3, -3, 0), (3, -3, 0), (-3, 3, 0),
    (3, 3, 0), (-3, -3, 8), (3, -3, 8),
    (-3, 3, 8), (3, 3, 8), (2.9999998, -1, 0.99999952),
    (3.9999998, -1, 0.99999952), (2.9999998, 3, 0.99999952), (3.9999998, 3, 0.99999952),
    (2.9999998, -1, 6.9999995), (3.9999998, -1, 6.9999995), (2.9999998, 3, 6.9999995),
    (3.9999998, 3, 6.9999995), (-1.0000004, 1.0000014, 9.999999), (0.9999997, 1.0000014, 9.999999),
    (-1.0000004, 3.0000014, 9.999999), (0.9999997, 3.0000014, 9.999999), (-1.0000004, 1.0000014, 10.999999),
    (0.9999997, 1.0000014, 10.999999), (-1.0000004, 3.0000014, 10.999999), (0.9999997, 3.0000014, 10.999999),
    (-2.0000002, 3.0000014, 9.999999), (1.9999996, 3.0000014, 9.999999), (-2.0000002, 5.0000014, 9.999999),
    (1.9999996, 5.0000014, 9.999999), (-2.0000002, 3.0000014, 11.999999), (1.9999996, 3.0000014, 11.999999),
    (-2.0000002, 5.0000014, 11.999999), (1.9999996, 5.0000014, 11.999999), (-2.0000002, 1.000001, 6.999999),
    (1.9999996, 1.000001, 6.999999), (-2.0000002, 7.000001, 6.999999), (1.9999996, 7.000001, 6.999999),
    (-2.0000002, 1.000001, 9.999999), (1.9999996, 1.000001, 9.999999), (-2.0000002, 7.000001, 9.999999),
    (1.9999996, 7.000001, 9.999999), (-3.0000002, -1, 0.99999952), (-4, -1, 0.99999952),
    (-3.0000002, 3, 0.99999952), (-4, 3, 0.99999952), (-3.0000002, -1, 6.9999995),
    (-4, -1, 6.9999995), (-3.0000002, 3, 6.9999995), (-4, 3, 6.9999995),
    (-1.0000006, -8, 4.0000005), (-2.0000005, -8, 4.0000005), (-1.0000006, -3, 4.0000005),
    (-2.0000005, -3, 4.0000005), (-1.0000006, -7.9999995, 6.000001), (-2.0000005, -7.9999995, 6.000001),
    (-3.0000005, -8, 4.0000005), (-3.0000005, -7.999999, 6.000001), (-3.5762787e-07, -8, 4.0000005),
    (-3.5762787e-07, -7.999999, 6.000001), (-1.0000006, -7.999999, 7.000001), (-2.0000005, -7.999999, 7.000001),
    (0.99999988, -8, 4.0000005), (1.9999999, -8, 4.0000005), (0.99999988, -3, 4.0000005),
    (1.9999999, -3, 4.0000005), (0.99999988, -7.9999995, 6.000001), (1.9999999, -7.9999995, 6.000001),
    (2.9999995, -8, 4.0000005), (2.9999995, -7.999999, 6.000001), (-3.5762787e-07, -8, 4.0000005),
    (-3.5762787e-07, -7.999999, 6.000001), (0.99999988, -7.999999, 7.000001), (1.9999999, -7.999999, 7.000001),
]
FACES = [
    (0, 2, 3, 1), (4, 5, 7, 6), (0, 1, 5, 4), (1, 3, 7, 5),
    (3, 2, 6, 7), (2, 0, 4, 6), (8, 10, 11, 9), (12, 13, 15, 14),
    (8, 9, 13, 12), (9, 11, 15, 13), (11, 10, 14, 15), (10, 8, 12, 14),
    (20, 21, 23, 22), (16, 17, 21, 20), (17, 19, 23, 21), (18, 16, 20, 22),
    (24, 26, 27, 25), (28, 29, 31, 30), (24, 25, 29, 28), (25, 27, 31, 29),
    (27, 26, 30, 31), (26, 24, 28, 30), (32, 34, 35, 33), (36, 37, 39, 38),
    (32, 33, 37, 36), (33, 35, 39, 37), (35, 34, 38, 39), (34, 32, 36, 38),
    (40, 41, 43, 42), (44, 46, 47, 45), (40, 44, 45, 41), (41, 45, 47, 43),
    (43, 47, 46, 42), (42, 46, 44, 40), (51, 49, 48, 50), (49, 53, 52, 48),
    (49, 54, 55, 53), (52, 57, 56, 48), (53, 59, 58, 52), (60, 61, 63, 62),
    (61, 60, 64, 65), (61, 65, 67, 66), (64, 60, 68, 69), (65, 64, 70, 71),
]
LOOP_UVS = [
    (0.28095311, 0.76567203), (0.1875, 0.76567203), (0.1875, 0.85934001), (0.28095311, 0.85934001),
    (0.093936831, 0.76567203), (0.1875, 0.76567203), (0.1875, 0.85934001), (0.093936831, 0.85934001),
    (0.28095311, 0.64066511), (0.375, 0.64066511), (0.375, 0.76567203), (0.28095311, 0.76567203),
    (0, 0.64066511), (0.093928903, 0.64066511), (0.093928903, 0.76567203), (0, 0.76567203),
    (0.093928911, 0.64066511), (0.1875, 0.64066511), (0.1875, 0.76567203), (0.093928903, 0.76567203),
    (0.1875, 0.64066511), (0.28095311, 0.64066511), (0.28095311, 0.76567203), (0.1875, 0.76567203),
    (0.5, 0.64088142), (0.5, 0.69999999), (0.46840659, 0.69999999), (0.46840659, 0.64088142),
    (0.35964775, 0.64088142), (0.37527302, 0.64088142), (0.37527302, 0.69999999), (0.35964775, 0.69999999),
    (0.5, 0.70313919), (0.48752156, 0.70313919), (0.48750001, 0.79676461), (0.5, 0.79676461),
    (0.46840659, 0.64088142), (0.46840659, 0.69999999), (0.37527302, 0.69999999), (0.37527302, 0.64088142),
    (0.46840659, 0.70313919), (0.48752156, 0.70313919), (0.48750001, 0.79676461), (0.46840659, 0.79676461),
    (0.5, 0.69999999), (0.5, 0.64088142), (0.59354818, 0.64088142), (0.59354818, 0.69999999),
    (0.25, 0.875), (0.3125, 0.875), (0.3125, 0.90626949), (0.25, 0.90626949),
    (0.25, 0.9375), (0.3125, 0.9375), (0.3125, 0.90626949), (0.25, 0.90626949),
    (0.34351483, 0.875), (0.34351483, 0.90626949), (0.3125, 0.90626949), (0.3125, 0.875),
    (0.21867812, 0.90626949), (0.21867812, 0.875), (0.25, 0.875), (0.25, 0.90626949),
    (0.40000001, 0.9375), (0.40000001, 0.9687618), (0.34378138, 0.9687618), (0.34378138, 0.9375),
    (0.25, 0.9375), (0.3125, 0.9375), (0.3125, 0.9687618), (0.25, 0.9687618),
    (0.3125, 1), (0.375, 1), (0.375, 0.9687618), (0.3125, 0.9687618),
    (0.34378138, 0.9375), (0.34378138, 0.9687618), (0.3125, 0.9687618), (0.3125, 0.9375),
    (0.3125, 1), (0.25, 1), (0.25, 0.9687618), (0.3125, 0.9687618),
    (0.21883895, 0.9687618), (0.21883895, 0.9375), (0.25, 0.9375), (0.25, 0.9687618),
    (0.21856317, 0.85944319), (0.21856317, 0.95287472), (0.15643686, 0.95287472), (0.15643686, 0.85944319),
    (0.046929229, 0.85944319), (0.10942923, 0.85944319), (0.10942923, 0.95287472), (0.046929225, 0.95287478),
    (0.69155073, -0.43736386), (0.97612214, -0.43736386), (0.97612214, -0.22393525), (0.69155073, -0.22393525),
    (0.15643685, 0.85944319), (0.15643685, 0.95287472), (0.10942924, 0.95287472), (0.10942924, 0.85944319),
    (0.10949959, 1), (0.04685181, 1), (0.046929225, 0.95287478), (0.10954423, 0.95287472),
    (0, 0.95287472), (0, 0.85944319), (0.046929229, 0.85944319), (0.046929225, 0.95287478),
    (0.5, 0.64088142), (0.46840659, 0.64088142), (0.46840659, 0.69999999), (0.5, 0.69999999),
    (0.35964775, 0.64088142), (0.35964775, 0.69999999), (0.37527302, 0.69999999), (0.37527302, 0.64088142),
    (0.5, 0.70313919), (0.5, 0.79676461), (0.48750001, 0.79676461), (0.48752156, 0.70313919),
    (0.46840659, 0.64088142), (0.37527302, 0.64088142), (0.37527302, 0.69999999), (0.46840659, 0.69999999),
    (0.46840659, 0.70313919), (0.46840659, 0.79676461), (0.48750001, 0.79676461), (0.48752156, 0.70313919),
    (0.5, 0.69999999), (0.59354818, 0.69999999), (0.59354818, 0.64088142), (0.5, 0.64088142),
    (0.57499999, 0.94999999), (0.57499999, 0.875), (0.5625, 0.875), (0.5625, 0.94999999),
    (0.53122175, 0.95316732), (0.53122175, 0.98438907), (0.51561093, 0.98438907), (0.51561093, 0.95316732),
    (0.53122175, 0.95316732), (0.54683268, 0.95316726), (0.54683268, 0.98438907), (0.53122175, 0.98438907),
    (0.51561093, 0.98438907), (0.5, 0.98438907), (0.5, 0.95316732), (0.51561093, 0.95316732),
    (0.53122175, 0.98438907), (0.53122175, 1), (0.51561093, 1), (0.51561093, 0.98438907),
    (0.5625, 0.875), (0.57499999, 0.875), (0.57499999, 0.94999999), (0.5625, 0.94999999),
    (0.53122175, 0.95316732), (0.51561093, 0.95316732), (0.51561093, 0.98438907), (0.53122175, 0.98438907),
    (0.53122175, 0.95316732), (0.53122175, 0.98438907), (0.54683268, 0.98438907), (0.54683268, 0.95316726),
    (0.51561093, 0.98438907), (0.51561093, 0.95316732), (0.5, 0.95316732), (0.5, 0.98438907),
    (0.53122175, 0.98438907), (0.51561093, 0.98438907), (0.51561093, 1), (0.53122175, 1),
]
LOOP_NORMALS = [
    (0, 0, -1), (0, 0, -1), (0, 0, -1),
    (0, 0, -1), (0, 0, 1), (0, 0, 1),
    (0, 0, 1), (0, 0, 1), (0, -1, 0),
    (0, -1, 0), (0, -1, 0), (0, -1, 0),
    (1, 0, 0), (1, 0, 0), (1, 0, 0),
    (1, 0, 0), (0, 1, 0), (0, 1, 0),
    (0, 1, 0), (0, 1, 0), (-1, 0, 0),
    (-1, 0, 0), (-1, 0, 0), (-1, 0, 0),
    (0, 0, -1), (0, 0, -1), (0, 0, -1),
    (0, 0, -1), (0, 0, 1), (0, 0, 1),
    (0, 0, 1), (0, 0, 1), (0, -1, 0),
    (0, -1, 0), (0, -1, 0), (0, -1, 0),
    (1, 0, 0), (1, 0, 0), (1, 0, 0),
    (1, 0, 0), (0, 1, 0), (0, 1, 0),
    (0, 1, 0), (0, 1, 0), (-1, 0, 0),
    (-1, 0, 0), (-1, 0, 0), (-1, 0, 0),
    (0, 0, 1), (0, 0, 1), (0, 0, 1),
    (0, 0, 1), (0, -1, 0), (0, -1, 0),
    (0, -1, 0), (0, -1, 0), (1, 0, 0),
    (1, 0, 0), (1, 0, 0), (1, 0, 0),
    (-1, 0, 0), (-1, 0, 0), (-1, 0, 0),
    (-1, 0, 0), (0, 0, -1), (0, 0, -1),
    (0, 0, -1), (0, 0, -1), (0, 0, 1),
    (0, 0, 1), (0, 0, 1), (0, 0, 1),
    (0, -1, 0), (0, -1, 0), (0, -1, 0),
    (0, -1, 0), (1, 0, 0), (1, 0, 0),
    (1, 0, 0), (1, 0, 0), (0, 1, 0),
    (0, 1, 0), (0, 1, 0), (0, 1, 0),
    (-1, 0, 0), (-1, 0, 0), (-1, 0, 0),
    (-1, 0, 0), (0, 0, -1), (0, 0, -1),
    (0, 0, -1), (0, 0, -1), (0, 0, 1),
    (0, 0, 1), (0, 0, 1), (0, 0, 1),
    (0, -1, 0), (0, -1, 0), (0, -1, 0),
    (0, -1, 0), (1, 0, 0), (1, 0, 0),
    (1, 0, 0), (1, 0, 0), (0, 1, 0),
    (0, 1, 0), (0, 1, 0), (0, 1, 0),
    (-1, 0, 0), (-1, 0, 0), (-1, 0, 0),
    (-1, 0, 0), (0, 0, -1), (0, 0, -1),
    (0, 0, -1), (0, 0, -1), (0, 0, 1),
    (0, 0, 1), (0, 0, 1), (0, 0, 1),
    (0, -1, 0), (0, -1, 0), (0, -1, 0),
    (0, -1, 0), (-1, 0, 0), (-1, 0, 0),
    (-1, 0, 0), (-1, 0, 0), (0, 1, 0),
    (0, 1, 0), (0, 1, 0), (0, 1, 0),
    (1, 0, 0), (1, 0, 0), (1, 0, 0),
    (1, 0, 0), (0, 0, 1), (0, 0, 1),
    (0, 0, 1), (0, 0, 1), (0, 1, -2.3841852e-07),
    (0, 1, -2.3841852e-07), (0, 1, -2.3841852e-07), (0, 1, -2.3841852e-07),
    (2.3841858e-07, 1, -3.5762778e-07), (2.3841858e-07, 1, -3.5762778e-07), (2.3841858e-07, 1, -3.5762778e-07),
    (2.3841858e-07, 1, -3.5762778e-07), (-2.3841852e-07, 1, -3.5762775e-07), (-2.3841852e-07, 1, -3.5762775e-07),
    (-2.3841852e-07, 1, -3.5762775e-07), (-2.3841852e-07, 1, -3.5762775e-07), (0, 1, -4.7683716e-07),
    (0, 1, -4.7683716e-07), (0, 1, -4.7683716e-07), (0, 1, -4.7683716e-07),
    (0, 0, 1), (0, 0, 1), (0, 0, 1),
    (0, 0, 1), (0, 1, -2.3841852e-07), (0, 1, -2.3841852e-07),
    (0, 1, -2.3841852e-07), (0, 1, -2.3841852e-07), (-2.3841866e-07, 1, -3.5762778e-07),
    (-2.3841866e-07, 1, -3.5762778e-07), (-2.3841866e-07, 1, -3.5762778e-07), (-2.3841866e-07, 1, -3.5762778e-07),
    (2.3841852e-07, 1, -3.5762778e-07), (2.3841852e-07, 1, -3.5762778e-07), (2.3841852e-07, 1, -3.5762778e-07),
    (2.3841852e-07, 1, -3.5762778e-07), (0, 1, -4.7683716e-07), (0, 1, -4.7683716e-07),
    (0, 1, -4.7683716e-07), (0, 1, -4.7683716e-07),
]

def ensure_collection(name: str) -> bpy.types.Collection:
    col = bpy.data.collections.get(name)
    if col is None:
        col = bpy.data.collections.new(name)
        bpy.context.scene.collection.children.link(col)
    return col

def rot_xyz(v):
    x, y, z = v
    rx = math.radians(ROT_X_DEG)
    ry = math.radians(ROT_Y_DEG)
    rz = math.radians(ROT_Z_DEG)
    cx, sx = math.cos(rx), math.sin(rx)
    cy, sy = math.cos(ry), math.sin(ry)
    cz, sz = math.cos(rz), math.sin(rz)

    y, z = (cx*y - sx*z), (sx*y + cx*z)
    x, z = (cy*x + sy*z), (-sy*x + cy*z)
    x, y = (cz*x - sz*y), (sz*x + cz*y)
    return (x, y, z)

def rot_xyz_n(v):
    x, y, z = rot_xyz(v)
    l = math.sqrt(x*x + y*y + z*z)
    if l > 0.0:
        x, y, z = x/l, y/l, z/l
    return (x, y, z)

def main():
    col = ensure_collection(COLLECTION_NAME)

    v2 = [rot_xyz(v) for v in VERTS]
    n2 = [rot_xyz_n(n) for n in LOOP_NORMALS]

    mesh = bpy.data.meshes.new(MESH_NAME)
    obj = bpy.data.objects.new(OBJECT_NAME, mesh)
    col.objects.link(obj)

    mesh.from_pydata(v2, [], FACES)
    mesh.validate(verbose=False)
    mesh.update(calc_edges=True)

    if len(LOOP_UVS) == len(mesh.loops):
        uv_layer = mesh.uv_layers.new(name=UV_LAYER_NAME)
        for i in range(len(mesh.loops)):
            u, v = LOOP_UVS[i]
            if FLIP_V:
                v = 1.0 - v
            uv_layer.data[i].uv = (u, v)

    try:
        if len(n2) == len(mesh.loops):
            mesh.normals_split_custom_set(n2)
    except Exception as e:
        print("Normals skipped:", e)

    mat = bpy.data.materials.get("02 - Default") or bpy.data.materials.new("02 - Default")
    try:
        mat.use_nodes = True
    except Exception:
        pass
    if len(mesh.materials) == 0:
        mesh.materials.append(mat)

    if MOVE_TO_ORIGIN:
        obj.location = (0.0, 0.0, 0.0)
        obj.scale = (0.1, 0.1, 0.1)

    bpy.ops.object.select_all(action="DESELECT")
    obj.select_set(True)
    bpy.context.view_layer.objects.active = obj

if __name__ == "__main__":
    main()